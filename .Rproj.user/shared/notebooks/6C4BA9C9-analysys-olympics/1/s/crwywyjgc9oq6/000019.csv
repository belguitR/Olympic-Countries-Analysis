"0",""
"0","# Get list of valid countries from GDP and Population datasets"
"0","valid_countries <- union(gdp_long$Country, pop_long$Country) %>% unique()"
"0",""
"0","# Prepare and merge only valid countries"
"0","athletes_merged <- athletes_clean %>%"
"0","  rename(Country = Team) %>%"
"0","  filter(Country %in% valid_countries) %>%   # âœ… filter here"
"0","  mutate(Year = as.integer(Year)) %>%"
"0","  left_join(gdp_long, by = c(""Country"", ""Year"")) %>%"
"0","  left_join(pop_long, by = c(""Country"", ""Year""))"
"0",""
"0","# Check result"
"0","head(athletes_merged)"
