---
title: "Olympic Athletes with GDP and Population"
output: html_document
date: "2025-04-14"
---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
We first start by reading the input data

```{r load_data, message=FALSE, warning=FALSE}

# Load athlete data
athletes <- read.csv("C:/Users/errmi/Desktop/MPSL/athlete_events.csv")

# Load GDP data (skip first 4 metadata rows)
gdp <- read.csv("C:/Users/errmi/Desktop/MPSL/API_NY.GDP.PCAP.CD_DS2_en_csv_v2_26433.csv", skip = 4)

# Load population data (skip first 4 metadata rows)
population <- read.csv("C:/Users/errmi/Desktop/MPSL/API_SP.POP.TOTL_DS2_en_csv_v2_26346.csv", skip = 4)
```


we will now get rid of redundunt columns in the olympics dataset ( by removing the columns season , Event and games)

```{r}
athletes_clean <- athletes[, !(names(athletes) %in% c("Season", "Games", "Event"))]

head(athletes_clean)
```

then we change the format of the two datasets taken from world bank data to put them in long format instead of the original wide format

```{r}
library(tidyverse)
library(readr)

# GDP long format
gdp_long <- gdp %>%
  select(`Country.Name`, starts_with("X19"), starts_with("X20")) %>%
  pivot_longer(cols = starts_with("X"), names_to = "Year", values_to = "GDP") %>%
  mutate(Year = as.integer(sub("X", "", Year))) %>%
  rename(Country = `Country.Name`)

# Population long format
pop_long <- population %>%
  select(`Country.Name`, starts_with("X19"), starts_with("X20")) %>%
  pivot_longer(cols = starts_with("X"), names_to = "Year", values_to = "Population") %>%
  mutate(Year = as.integer(sub("X", "", Year))) %>%
  rename(Country = `Country.Name`)

# Preview
head(gdp_long)
head(pop_long)

```
 after filtering the countries using a list from the gdp and populations datasets since the column team in athletes dataset sometimes has non country elements , we will then merge the three datasets left joining using the year  and the country which corresponds to the column team in the athlets dataset 

```{r}

# Get list of valid countries from GDP and Population datasets
valid_countries <- union(gdp_long$Country, pop_long$Country) %>% unique()

# Prepare and merge only valid countries
athletes_merged <- athletes_clean %>%
  rename(Country = Team) %>%
  filter(Country %in% valid_countries) %>%   # ✅ filter here
  mutate(Year = as.integer(Year)) %>%
  left_join(gdp_long, by = c("Country", "Year")) %>%
  left_join(pop_long, by = c("Country", "Year"))

# Check result
head(athletes_merged)
```
after mergng the data and in order to make the first graphs we ll have to filter everytime what s is not available such as the GDP and population 

```{r}
# Total medals per country (across all years)
medals_summary <- athletes_merged %>%
  filter(!is.na(Medal)) %>%  # Only count actual medals
  group_by(Country) %>%
  summarise(
    Total_Medals = n(),
    GDP = max(GDP, na.rm = TRUE),
    Population = max(Population, na.rm = TRUE),
    .groups = "drop"
  )

# Check result
head(medals_summary)
```


```{r}
library(dplyr)
library(ggplot2)

# Clean the data
medals_clean <- medals_summary %>%
  filter(
    !is.na(GDP),
    !is.na(Total_Medals),
  )

# Plot with full Y axis
ggplot(medals_clean, aes(x = GDP, y = Total_Medals)) +
  geom_point(alpha = 0.6, color = "#00BFC4", size = 2) +  # Blue-green points
  geom_smooth(method = "lm", se = TRUE, color = "darkred", size = 1.2) +
  scale_x_log10() +
  labs(
    title = "Relationship between GDP per Capita and Total Olympic Medals",
    x = "GDP per Capita (log scale)",
    y = "Total Medals (All-Time)"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 16, face = "bold"),
    axis.text = element_text(size = 11),
    axis.title = element_text(size = 13)
  )



```
the relationship between GDP per capita and the total number of Olympic medals won by countries. Overall, there is a weak but noticeable positive trend, suggesting that countries with higher GDP per capita tend to win more medals. However, the correlation is not strong  countries with modest GDP still achieve high medal counts, likely due to strong sports infrastructure or cultural emphasis on athletics. Conversely, many wealthy countries cluster with low to moderate medal counts. This implies that while economic wealth can support athletic success, it is not the only determining factor

```{r}
library(ggplot2)
library(dplyr)

# Filter out countries with missing population
medals_summary_clean <- medals_summary %>%
  filter(!is.na(Population))

ggplot(medals_summary_clean, aes(x = Population, weight = Total_Medals)) +
  geom_histogram(bins = 30, fill = "tomato", color = "white") +
  scale_x_log10() +  
  labs(
    title = "Distribution of Olympic Medals by Country Population",
    x = "Population (log scale)",
    y = "Total Medals "
  ) +
  theme_minimal()





```
From the graph, we can observe that countries with mid-sized populations (around 10 million to 500 million) tend to win the most medals overall. On the other hand  countries with very large populations (above 1 billion) and very small populations (under 1 million) contribute fewer medals in total. This suggests that while population size can provide a larger talent pool, other factors like GDP

countries with  mid-sized populations usualy are the developed countries such as europe japan and north america that explains the important number of medals The only major outlier beyond the 1 billion population mark in Olympic medal count is likely China, as it consistently secures a high number of medals, unlike India which, despite a similarly large population, contributes fewer medals overall.




```{r}
library(ggplot2)
library(dplyr)


medals_colored <- medals_summary %>%
  filter(!is.na(GDP) & !is.na(Population))

ggplot(medals_colored, aes(x = GDP, y = Total_Medals, color = Population)) +
  geom_point(alpha = 0.7, size = 3) +
  scale_x_log10() +
  scale_color_gradient(low = "lightblue", high = "darkred", name = "Population") +
  labs(
    title = "Olympic Medals vs GDP per Capita (Color = Population)",
    x = "GDP per Capita (log scale)",
    y = "Total Olympic Medals"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 14),
    axis.title = element_text(size = 12)
  )

```
we can conclude that  countries with higher GDP per capita generally win more Olympic medals, especially those with moderate to large populations. While most high-population countries cluster at lower medal counts, a few exceptions—likely including China and the U.S.—stand out with both high population and high medal tallies. Overall, GDP per capita appears to be a stronger a stronger indicator of Olympic success than population alone.
